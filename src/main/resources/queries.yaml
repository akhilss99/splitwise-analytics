instamart: >-
  select *, 'instamart' as purchase 
  from
     expenses 
  where
     description ilike '%instamart%'
swiggy: >-
  select *, 'swiggy' as purchase 
  from
     expenses 
  where
     description not ilike '%instamart%' 
     and description ilike '%swiggy%'
supermarket: >-
  select *, 'supermarket' as purchase
  from 
     expenses
  where 
     description ilike '%supermarket%'
bigbasket: >-
  select *, 'bigbasket' as purchase
  from 
     expenses
  where 
     description ilike '%big%' 
     and description ilike '%basket%'
result: >-
  with cumulative_expense as (
    select * from instamart
    union all
    select * from swiggy
    union all
    select * from supermarket
    union all
    select * from bigbasket
  ),
  monthly_partitioned_expense as (
    select DISTINCT
       purchase,
       pk,
       sum(cost) over(partition by pk, purchase) as cost 
    from
       cumulative_expense 
    order by
       year desc,
       month,
       purchase
  )
  
  PIVOT monthly_partitioned_expense on purchase using sum(cost);